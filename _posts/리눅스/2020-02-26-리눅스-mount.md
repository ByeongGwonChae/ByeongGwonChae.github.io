---
title: "리눅스 - mount"
category:
  - linux
tag:
  - linux
  - mount
toc: true
toc_sticky: true
---

# 현재 시스템이 지원하는 파일 시스템 확인하기

```
cat proc/filesystem
```

![1](/assets/images/2020-02-26-리눅스-mount/1.PNG)

nodev의 의미 : 해당 파일이 블록 장치(디스크)와 연결되어 있지 않다. 가상 파일 시스템을 의미한다.

# 스왑 파티션 관리하기

스왑 파티션 : 메모리 영역으로 사용하기 위해 할당한 디스크 영역. 메모리 용량이 모자랄 경우, HDD 등의 저장 공간에 스왑 파티션을 만들어서, 추가 메모리 영역처럼 사용한다.

## 현재 스왑 영역 확인하기

```
swapon -s
```

![2](/assets/images/2020-02-26-리눅스-mount/2.PNG)

## 새로운 디스크 파티션을 스왑 영역으로 추가하기

① fdisk로 디스크에 스왑 파티션 생성.
 
② 
 
③ 
 
④ 
 
⑤ 

## 기본 파티션에 스왑 파일 추가하기

①②③④⑤⑥

# ext4 파일 시스템 구조

ext4의 블록 그룹은 0, a, b로 3가지가 있다.

|블록 그룹 0|그룹 0<br>패딩|ext4<br>슈퍼블록|그룹<br>디스크립터|GDT<br>예약 블록|데이터<br>블록<br>비트맵|inode<br>비트맵|inode<br>테이블|데이터 블록|
|블록 그룹 a| |ext4<br>슈퍼블록|그룹<br>디스크립터|GDT<br>예약 블록|데이터<br>블록<br>비트맵|inode<br>비트맵|inode<br>테이블|데이터 블록|
|블록 그룹 b| | | | |데이터<br>블록<br>비트맵|inode<br>비트맵|inode<br>테이블|데이터 블록|

1) 그룹 0 패딩 : 1024 bytes. x86 부트 섹터와 부가 정보를 저장한다.
1) 슈퍼블록 : 파일 시스템과 관련된 다양한 정보가 저장된다. 슈퍼블록에 문제가 생길 경우 1)전체 파일시스템이 망가지기에, 슈퍼블록을 다른 블록 그룹에 복사하고, 슈퍼블록이 망가졌을 1)경우 다른 블록의 복사본을 사용하여 복구한다.
1) 그룹 디스크립터 : 다양한 정보가 저장된다. 슈퍼블록처럼 다른 블록 그룹에 복사된다.
1) GDT 예약 블록 : 그룹 디스크립터의 확장을 윟나 예비 공간이다.
1) 데이터 블록 비트맵 : 블록 그룹에 포함된 데이터 블록의 사용 여부를 확인하는데 사용된다.
1) inode 비트맵 : inode 테이블의 항목(inode)이 사용 중인지를 표시한다. 
1) inode 테이블 : 데이터 블록에 저장된 파일/디렉터리의 정보를 가진다. `ls -l` 명령으로 확인 가능하다.
1) 데이터 블록 : 실제 데이터가 저장된다. 일반 파일은 1)데이터 블록에 실제 파일 내용을 저장하고, 디렉터리는 해당 디렉터리에 있는 파일이나 서브 1)디렉터리의 이름과 inode를 저장한다.

리눅스에서 ext4는 표준 파일 시스템이라 불릴만큼 주로 사용되며, ext4의 디렉터리 계층 구조에서 특정 디렉터리에 마운트를 통해 여러 파일 시스템을 사용하는 것도 가능하다.

# 마운트

마운트 : 파일 시스템을 디럭테리 계층 구조의 특정 디렉터리와 연결하는 것
<br>
마운트 포인트 : 마운트가 실행된 특정 디렉터리

/etc/fstab 파일 : 파일 시스템의 마운트 설정 정보를 가지고 있다. 리눅스 시스템은 부팅할 때 이 파일을 읽고 설정 내용에 따라 파일 시스템을 자동으로 마운트한다. 이 파일에 오류가 있을 경우 시스템 부팅이 중지될 수도 있다.

![3](/assets/images/2020-02-26-리눅스-mount/3.PNG)


|file system|mount point|type|option|dump|pass|

① file system : 파일 시스템의 장치명. /dev/hda1, /dev/sda1와 같이 특정 디스크를 지정하는 것이다. 
<br>
- UUID : 로컬 시스템과 다른 시스템에서 파일 시스템을 유일하게 구분해주는 128비트의 숫자. 디스크가 추가될 때 부트 로더를 가지고 있는 부트 장치의 이름이 바뀌는 것을 방지하기 위해 사용되며, 시스템의 하드웨어 정보와 시간 정보를 조합하여 랜덤으로 생성된다. /dev/disk/by-uuid 디렉터리에서 UUID로 지정된 장치를 찾을 수 있다.

![4](/assets/images/2020-02-26-리눅스-mount/4.PNG)

② mount point : 파일 시스템이 마운트될 마운트 포인트.

③ type : 파일 시스템의 종류.

④ option : 파일 시스템의 속성을 지정하는 옵션. 다음과 같은값들이 올 수 있다.

- 
|속성|의미|
|-|-|
|defaults|일반적인 파일 시스템에 지정하는 속성.<br>rw, nouser, auto, exec, suid 속성을 포함한다.|
|auto|부팅시 자동 마운트|
|exec|실행 파일이 실행되는 것을 허용.|
|suid|setuid, setgid의 사용을 허용한다.|
|ro|읽기 전용 파일 시스템|
|rw|읽기,쓰기가 가능한 파일 시스템|
|user|일반 사용자도 마운트가 가능|
|nouser|일반 사용자의 마운트가 불가능<br>root계졍만 마운트 가능|
|noauto|부팅시 자동으로 마운트하지 않는다.|
|noexec|실행 파일이 실행되는 것을 허용하지 않는다.|
|nosuid|setuid, setgid의 사용을 금지한다.|
|usrquota|사용자별로 디스크 쿼터 설정 가능|
|grpquota|그룹별로 디스크 쿼터 설정 가능|
|errors=remount-ro|오류 발생시 읽기전용으로 다시 마운트|

⑤ dump : 덤프 관련 설정.
- |0|dump 명령으로 파일 시스템의 내용이 덤프되지 않는 파일 시스템|
|1|데이터 백업 등을 위해 dump 명령의 사용이 가능한 파일 시스템|

⑥ pass : 파일 점검 옵션

|0|부팅시 fsck 명령으로 파일 시스템 점검을 하지 않는다|
|1|부팅시 루트 파일 시스템이 fsck 명령 실행|
|2|부팅시 루트를 제외한 파일 시스템들이 나열된 순서대로 fsck명령 실행|


## 마운트 관련 명령



ㄹ

# ㄹㅇㄴ

~~~
mount [옵션] 장치명 마운트포인트
파일 시스템을 마운트한다.
-t : 파일시스템 종류 : 파일 시스템의 종류를 지정한다.
-o : 마운트 옵션 : 마운트 옵션을 지정한다.
-f : 마운트할 수 있는지 점검한 한다.
-r : 읽기만 가능하게 마운트한다.
~~~

~~~
umount [옵션] 장치명 or 마운트포인트
-t 파일시스템 종류 : 파일시스템의 종류를 지정한다.
~~~

##

디스크 추가 단계 : 새 디스크 장착하기→디스크 파티션 나누기→파티션에 파일시스템 생성하기(포맷)→디스크마운트
가상머신 : SCSI, SATA, IDE
파티션 : 하나의 디스크를 독립된 영역으로 구분하는 것
숫자가 붙지 않으면 디스크 장치 전체를 가리키고, 숫자가 붙을 경우 해당 디스크의 구분된 각 타피션을 뜻한다. 디스크 전체를 하나의 파티션으로 사용하려고 할 때도 파티션 작업은 반드시 해야한다.

#

디스크 파티션 나누기 fdisk
파일시스템 생성 mkfs, mke2fs
디스크 마운트 mount /dev/sdb1/mnt

~~~
fdisk [옵션] 장치명
디스크의 파티션 생성, 삭제, 보기 등 파티션을 관리한다.
-b <크기> : 섹터 크기를 지정한다(512,1024,2048,4096).
-l : 파티션 테이블을 출력한다.
~~~

~~~
리눅스 파일 시스템을 만든다
-t 종류 : 파일 시스템의 종류를 지정한다.(기본 값은 ext2)
~~~

~~~
ㅡmke2fs [옵션] 장ㅇ치명
리눅스 개정판 확장 파일 시스템(ext2, ext3, ext4)을 만든다.
-t 종류 : 파일 시스템의 종류를 지정한다.
-b 블록 크기 : 블록 크기를 바이트 수로 지정한다.
-c : 배드 블록을 체크한다.
-f : 프래그먼트 크기 : 프래그먼트 크기를 바이트 수로 지정한다.
-i inode당 바이트 수 : inode당 바이트 수르를 지정한다. 기본값은 4096바이트다.
-m 예약 블록 퍼센트 : 슈퍼유저에게 예약해둘 블록의 퍼센트를 지정한다. 기본값은 5%이다.
~~~

#

디스크 사용량 확인 : df, du
파일 시스템 검사 및 복구 : e2fsck, fsck

~~~
df [옵션] [파일 시스템]
디스크의 남은 공간에 대한 정보를 출력한다.
-a : 모든 파일 시스템을 대상으로 디스크 사용량을 확인한다.
-k : 디스크 사용량을 KB단위로 출력한다.
-m : 디스크 사용량을 MB단위로 출력한다.
-h : 디스크 사용량을 알기 쉬운 단위(GB, MB, KB 등)로 출력한다.
-t 파일시스템 종류 : 지정한 파일시슷템의 종류에 해당하는 디스크 사용량을 출력한다.
-T : 파일 시스템의 종류도 출력한다.
~~~

~~~
du [옵션] [디렉터리]
디스크의 사용 공간에 대한 정보를 출력한다.
-s : 특정 디렉터리의 전체 사용량을 출력한다.
-h : 디스크 사용량을 알기 쉬운 단위(GB, MB, KB 등)로 출력한다.
~~~

~~~
fsck [옵션] 장치명
리눅스의 파일시스템을 검사한다.
-f : 강제 점검한다.
-b 슈퍼블록 : 지정한 백업 슈퍼블록을 사용한다.
-y : 모든 질문에 yes로 대답하게 한다.
-a : 파일시스템 검사에서 문제가 발생했을 때 자동으로 복구한다.
~~~

기본적으로 /etc/fstab에 지정된 파일시스템을 대상으로 한다.

~~~
e2fsck [옵션] 장치명
리눅스의 확장 파일 시스템(ext2, ext3, ext4)을 검사한다.
-f : 강제 점검한다.
-b 슈퍼블록 : 지정한 백업 슈퍼블록을 사용한다.
-y : 모든 질문에 yes로 대답하게 한다.
-j ext3/ext4 : ext3나 ext4 파일시스템을 검사할 때 지정한다.
~~~

#
~~~

~~~

#
~~~

~~~

#
~~~

~~~
