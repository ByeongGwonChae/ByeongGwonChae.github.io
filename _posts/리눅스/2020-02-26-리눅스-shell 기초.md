---
title: "리눅스 - shell 관련 명령어"
category:
  - linux
tag:
  - linux
  - shell
toc: true
toc_sticky: true
---

이 포스트는 우분투 리눅스에서 bash를 다루는 것을 기준으로 하고 있다.

# 쉘 확인 및 변경

## 쉘 확인

- 모든 쉘 확인

`cat /etc/shells` 을 통해 모든 쉘 목록을 확인할 수 있다.

- 리눅스의 기본 쉘 확인

```
ls -l /bin/sh
```

- 현재 사용 중인 쉘 확인

```
grep 사용자명 /etc/passwd
```

## 현재 사용 중인 쉘 변경

먼저 `cat /etc/shells`이나 `chsh -l`을 통해 바꿀 수 있는 쉘을 확인한다.

~~~
chsh [옵션] [사용자명]
사용자 로그인 shell을 바꾼다.

-s shell명 사용자명 : 지정하는 shell(절대 경로)로 로그인 shell을 바꾼다.
-l : /etc/shells 파일에 지정된 shell을 출력한다.
~~~

로그인 shell이 바뀌었는지는 /etc/passwd 파일을 확인해보면 된다.

## 로그인 쉘과 서브 쉘

- 로그인 쉘 : 사용자가 로그인하면 자동으로 생성되는 기본 쉘
- 서브 쉘 : 로그인 쉘의 프롬프트에서 생성한 다른 쉘

로그인 쉘은 서브쉘을 생성할 수 있고, 또한 서브 쉘은 또 다른 서브 쉘을 생성할 수 있다. (로그인 쉘 → 서브 쉘 → 서브 쉘)

서브 쉘을 만들때는 /etc/shells의 쉘들을 사용할 수 있고`(예: $sh)`,<br>
Ctrl+d, exit 등으로 서브 쉘을 종료할 수 있다.

# 쉘 내장 명령

일반적인 리눅스 명령이 /bin과 /usr/bin 디렉터리에 별도의 실행 파일로 있는 것과 달리,<br>
쉘 내장 명령은 별도의 실행 파일이 없고 셸 안에 포함되어 있다.

아래 명령들은 bash를 기준으로 설명하고 있다.

## 출력 명령

bash는 echo와 printf의 출력 명령이 있는데, 이 중 echo는 모든 쉘에서 공통적으로 제공하는 출력 명령이다.<br>
출력 명령은 문자열, 쉘 변수 값, 명령 결과 등을 출력하는데 사용된다.

```
echo [-n] [문자열···]
화면에 한 줄의 문자열을 출력한다.

-n : 마지막에 줄 바꿈을 하지 않는다.
```

```
printf 형식 [인수···]
C언어의 printf처럼 데이터 형식을 지정하여 출력한다.
```

## bash 환경 설정

쉘의 환경 설정값은 쉘 변수, 환경 변수에 저장된다.<br>
이 변수들에는 사용자 정보, 명령을 찾아오는 경로 지정, 각 사용자의 프롬프트 모양 등 다양한 정보가 저장되어 있다.

- 쉘 변수 : 현재 쉘에서만 사용이 가능하고 서브 쉘로는 전달되지 않는다.
- 환경 변수 : 현재 쉘뿐만 아니라 서브 쉘로도 전달된다.

|주요 환경 변수|의미|
|---|---|
|HISTSIZE|히스토리 저장 크기|
|HOME|사용자 홈 디렉터리의 절대 경로|
|LANG|사용하는 언어|
|LOGNAME|사용자 계정 이름|
|PATH|명령을 탐색할 경로|
|PWD|작업 디렉터리 절대 경로|
|SHELL|로그인 쉘|

### 변수 출력하기

- 전체 변수 출력: set, env

```
set : 쉘 변수와 환경 변수를 모두 출력하는 명령어
env : 환경 변수만 출력하는 명령어
```

- 특정 변수 출력

~~~
echo $변수명
~~~

### 변수 설정/해제 하기

- 쉘 변수 설정

~~~
변수명=문자열
~~~

- 환경 변수 설정

환경 변수 설정은 먼저 쉘 변수를 정의하고, export로 쉘 변수를 환경 변수로 만들어야한다.

~~~
export [-n] [쉘 변수명]
지정한 쉘 변수를 환경 변수로 바꾼다.

-n : 환경 변수를 쉘 변수로 바꾼다.
~~~

지정한 shell 변수를 환경 변수로 바꾼다.

- 변수 해제

~~~
unset [변수명]
지정한 변수를 해제한다.
~~~

## alias

기존의 명령을 대신하여 다른 이름(별명)을 붙일 수 있는 기능이다.

다음과 같이 활용할 수 있다.

- 긴 명령 대신 짧은 명령을 만들 수 있다.
- 여러 명령을 연결하여 하나의 명령으로 만들 수 있다.
- 자주 사용하는 옵션을 포함하여 새로운 이름을 붙여서 사용할 수 있다.

### alias 설정/해제 하기

- 현재 설정된 alias 목록 출력

~~~
alias
~~~

- alias 설정

~~~
alias 이름='명령'
alias 이름='명령;명령2;···'
~~~

- alias 해제

~~~
unalias 이름
~~~

## history 

이전에 입력한 명령 목록을 출력한다. 사용자가 로그인하여 작업한 명령은 임시 버퍼에 저장되므로 다시 불러서 사용할 수 있다. 이는 history 명령으로 가능하다.

- 히스토리 목록 출력

~~~
history
히스토리(명령 입력 기록)을 출력한다.
~~~

- 명령 재실행하기

히스토리로 저장되어 있는 명령을 다시 불러서 재실행할 수 있다.

|재실행 명령어|설명|
|---|---|
|!!|바로 직전에 실행한 명령을 재실행|
|!번호|히스토리에서 해당 번호의 명령을 재실행|
|!문자열|히스토리에서 해당 문자열로 시작하는 마지막 명령을 재실행|

- 히스토리 저장하기

bash는 로그아웃할 때, 히스토리 목록을 ~/.bash_history에 저장한다.

# 환경 설정 파일

환경 설정 파일 : 사용자가 로그인할 때마다 자동으로 실행되는 명령을 저장한 파일

- alias 등은 설정해도 로그아웃하면 모두 사라지는데, 환경 설정 파일을 사용하면 사라지지 않는다.
- 환경 설정 파일에는 시스템 환경 설정 파일과 사용자 환경 설정 파일이 있다.
- 사용자가 로그인하면 먼저 시스템 환경 설정 파일이 실행되어 시스템 공통 환경을 만들고, 이후 사용자 환경 설정 파일을 순서대로 실행하여 사용자별 환경을 설정한다.
- 쉘마다 다른 이름의 파일을 사용하기 때문에, 사용자는 여러 쉘을 사용하면서 각 쉘마다 다른 환경을 꾸밀 수도 있다.
- 환경 설정 파일은 사용자가 로그인할 때 실행되어 사용자 환경을 초기화하므로 초기화 파일이라고도 부른다.

아래 내용들은 우분투의 bash의 환경 설정 파일을 기준으로 다루고 있다.

## 시스템 환경 설정 파일

시스템을 사용하는 전체 사용자의 공통 환경을 설정하는 파일

- 모든 사용자가 로그인할 때마다 무조건 실행된다.
- bash의 시스템 환경 설정 파일은 /etc 디렉터리에 있다.

|시스템 환경 설정 파일|기능|
|---|---|
|/etc/profile|sh이나 sh와 호환되는 모든 셸에 공통으로 적용되는 .profile 파일<br>- bash인 경우 /etc/bash.bashrc 파일을 실행한다.<br>- bash가 아닌 경우 프롬프트를 #(root 사용자)나 $(일반 사용자)로 설정한다.<br>- /etc/profile.d/*.sh 파일을 실행한다.|
|/etc/bash.bashrc|시스템 공통으로 적용되는 .bashrc 파일<br>- 기본 프롬프트를 설정한다.<br>- sudo명령과 관련된 힌트를 설정한다.|
|/etc/profile.d/\*.sh|- 언어나 명령별로 각각 필요한 환경을 설정한다.<br>- 필요시 설정 파일을 추가한다.|

이 중 profile과 bash.bashrc는 향후 리눅스 업데이트 시 일관성 있는 관리를 위해 수정하지 않는 것이 좋다.

시스템별로 환경을 다르게 구성할 필요가 있으면 /etc/profile.d에 .sh파일을 추가하도록 한다.

## 사용자 환경 설정 파일

각 사용자의 홈 디렉터리의 숨긴 파일

- 사용자가 내용을 수정하고 관리할 수 있다.

|사용자 환경 설정 파일|기능|
|---|---|
|~/.profile|- 경로 추가 등 사용자가 정의하는 환경을 설정한다.<br>- .bashrc 파일이 있으면 실행한다.|
|~/.bashrc|- 히스토리의 크기를 설정한다.<br>- 기본 alias나 함수 등을 설정한다.|
|~/.bash_aliases|- 사용자가 정의한 alias를 별도 파일로 설정한다.|
|~/.bash_logout|- 로그아웃 시 실행할 필요가 있는 함수 등을 설정한다.|

