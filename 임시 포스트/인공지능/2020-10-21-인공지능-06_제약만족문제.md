---
title: "인공지능-06. 제약 만족 문제"
category:
  - AI
tag:
  - AI
toc: true
toc_sticky: true
---

상태(state)를 그냥 작은 블랙박스가 아니라 그 이상의 것으로 간주하면 강력한 새 검색 방법들을 다양하게 만들어 낼 수 있고 문제의 구조와 복잡도를 더 깊이 이해할 수 있음을 배운다.

3~4장에서는 상태들의 공간을 검색해서 문제를 풀 수 있다는 착안을 살펴보았다. 그런 상태를 특정 영역에 국한된 발견법적 함수로 평가하고, 해당 상태가 목표 상태와 부합하는지 판정하면서 상태 공간을 검색한다. 그런데 검색 알고리즘의 관점ㅁ에서 각 상태는 더 분해할 수 없다는 뜻에서 원자적이다. 즉, 상태는 내부 구조가 드러나지 않는 일종의 블랙박스이다.

이번 장에서는 광범위한 문제들을 좀 더 효율적으로 푸는 방법 하나를 소개한다. 이번 장의 방법에서는 각 상태의 분해된 표현(factored representation)을 사용한다. 즉, 하나의 상태는 여러 변수의 집합으로 표현되며, 각 변수는 각자 하나의 값을 가진다. 모든 변수의 값이 해당 변수에 가해진 모든 제약(constraint, 구속조건)을 만족하면 문제가 풀린 것이다. 이런 식으로 서술하는 문제를 가리켜 제약만족 문제(constraint satisfaction problem, CSP)라고 부른다.

CSP 검색 알고리즘들은 상태의 구조를 활용하며, 복잡한 문제라도 문제에 고유한 발견법적 함수에 의존하지 않고 범용 발견법적 함수를 이용해서 해답을 구한다. 주된 착안은, 제약들의 위반하는 변수·값 조합을 식별함으로써 검색 공간의 커다란 부분을 단번에 제거한다는 것이다.







# 제약 만족 문제의 정의

CSP의 구성요소

1. X : 변수들의 집합
1. D : 변수 정의역(domain)들의 집합
1. C : 허용되는 값 조합들을 명시하는 제약들의 집합

- 배정(assignment)
- 일관된 배정(consistent assignment) : 어떤 제약도 위반하지 않는 배정
- 적법한 배정(legal assignment)
- 완전 배정(complete assignment) : 모든 변수가 배정된 것
- 부분 배정(partial assignment) : 일부 변수들에만 값이 배정된 것

CSP의 **해답**은 일관되고 완전한 배정이다.

제약 그래프(constraint graph)

## 예제 문제: 지도 색칠하기

## 예제 문제: 제조 일정 수립

## CSP 형식론의 변형들

가장 간단한 종류의 CSP는 변수들이 이산적이고 그 정의역이 유한한 경우이다. ex) 지도 채색 문제, 시간 제약이 있는 일정 수립, 8-퀸 문제

- 유한 정의역 CSP   ex) 8-퀸 문제
- 무한 정의역 CSP

제약 언어(constraint language) : 제약을 일일이 나열하지 않고 직접 이하하는 것(?)

- 선형 제약(linear constraint) : 각 변수가 선형으로만 나타나는 제약.
- 비선형 제약(nonlinear constraint) : 정수 변수에 대한 일반적인 제약. 존재하지 않음을 증명할 수 있다.
- 당항 제약(unary constraint) : 가장 간단한 종류의 제약은 하나의 변수가 가질 수 있는 값을 제한하는 제약.
- 이항 제약(binary constraint) : 변수 2개에 관한 것.
- 전역 제약(global constraint) : 임의의 개수의 변수들이 관여하는 제약. (전통적으로 쓰이는 용어. 문제의 모든 변수가 관여해야 하는 것은 아니라는 점에서 좀 혼란스러운 용어이다.)
- 선호 제약(preference constraint) : 현실의 CSP들에서, 여러 해답 중 어떤 해답을 더 선호할 것인지를 나타내는 제약.

- 제약 초그래프(constraint hypergraph) : 
- 쌍대 그래프(dual graph)

제약 최적화 문제(constraint optimization problem, COP) : 선호 제약이 있는 제약 만족 문제를 최적화 검색 방법들(경로 기반이든 국소 검색이든)을 이용해서 푸는 문제.

연속적 정의역(continuous domain)이 관여하는 제약 만족 문제가 흔하며, 경영과학 분야에서 그런 문제를 널리 연구하고 있다. ex) 허블 우주 망원경에 대한 실험 일정을 수립하려면 관측 시간을 아주 정교하게 설정할 필요가 있다.

연속적 정의역 CSP들 중 가장 잘 알려진 부류는 선형계획법(linear programming) 문제. 이 문제에서 제약들은 반드시 1차 연립방정식 또는 1차 연립부등식 형태이다. 선형계획법 문제 해결의 시간 복잡도는 변수 개수에 대해 다항식적이다. 제곱 계획법(quadratic programming) 문제나 2차 원뿔 계획법(second-order conic programming) 등 다른 종류의 제약과 목적 함수를 가진 여러 문제들도 연구되었다.



# 제약 전파: CSP의 추리

보통의 상태 공간 검색에서 알고리즘이 하는 일은 검색 하나이다. CSP에서는 두 종류의 알고리즘이 가능하다.

1. 검색(search) : 여러 가능성으로부터 새로운 변수 배정을 선택하는 알고리즘.
1. 제약 전파(constraint propagation) : 특정 종류의 추리(inference)를 수행하는 알고리즘.

국소 일관성(local consistency)
<br>
각 변수를 그래프의 한 노드로 간주할 대, 그래프의 각 부분에서 국소 일관성을 강제하는 과정을 반복하다 보면 그래프 전반에서 비일관적 값들이 제거된다. 국소 일관성에는 여러 종류가 있다.

- 노드 일관성(이항 제약)
- 호 일관성(단항 제약)
- 경로 일관성
- k-일관성
- 

## 노드 일관성

노드 일관적(node-consistent) 변수 : 어떤 한 변수(CSP 네트워크의 한 노드에 해당하는)의 정의역의 모든 값이 그 변수의 단항 제약들을 만족하는 변수

## 호 일관성

호 일관적(arc-consistent) 변수 : CSP의 한 변수의 정의역의 모든 값이 그 변수의 이항 제약들을 만족하는 변수.

## 경로 일관성

경로 일관성(path consistency) : 

## k-일관성

k-일관성(k-consistency)

강한 k 일관성(strong k-consistency)

## 전역 제약

전역 제약 : 임의의 개수의 변수들이 관여하는 제약.

자원 제약(resource constraint)

경계 전파(bounds propagation)

## 스도쿠 예제

# CSP를 위한 역추적 검색

교환성(commutativity, 가환성)

역추적 검색(backtracking search)

## 변수와 값의 순서 결정

최소 잔여 값(minimum-remaining-values, MRV) 발견법

차수 발견법(degree heuristic)

최소 제약 값(least-constraining-value) 발견법

## 검색과 추리의 교대 실행

전방 점검(forward checking) : 아주 간단한 형태의 추리

호 일관성 유지(Maintaining Arc Consistency, MAC) 알고리즘 : 

## 지능적인 역추적: 돌아보기

연대순 역추적(chronological backtracking) : ex) 가장 최근 결정 지점을 재방문

충돌 집합(conflict set)
역도약(backjumping) 방법 : 충돌 집합에 있는 가장 최근 배정으로 돌아간다.

충돌 지향 역도약(conflict-directed backjumping) 알고리즘 : 정의된 충돌 집합을 사용하는 역도양 알고리즘.

제약 학습(constraint learning) : 충돌 집합 중 문제를 일으킨 최소한의 변수들의 집합을 찾는다.

무익(no-good) 조합 : 






# CSP를 위한 국소 검색

국소 검색은 다양한 CSP를 푸는 데 효과적이다.

터부 검색(tabu search)

제약 가중(constraint weighting)

# 문제의 구조









# 요약

제약 만족문제(CSP)는 상태를 변수·값 쌍들의 집합으로 나타내고, 해답을 위한 조건들을 그 변수들에 대한 제약들의 집합으로 나타낸다. 실세계의 여러 주요 문제들을 CSP 형태로 서술할 수 있다.

제약들에 일관적인 변수/값 쌍들 중 그렇지 않은 것들을 파악하는 다양한 추론 기법이 있다. 노드 일관성, 호 일관성, 경로 일관성, k-일관성 적용이 그러한 기법의 예이다.

CSP를 풀 때에는 깊이 우선 검색의 일종인 역추적 검색이 흔히 쓰인다. 추리를 검색과 맞물려 수행할 수 있다.

최소 잔여 값 발견법과 차수 발견법은 역추적 검색에서 다음으로 조사할 변수를 선택하기 위한 문제 영역 독립적 방법이다. 최소 제약 값 발견법은 주어진 변수에 대해 처음으로 시도할 값을 결정하는데 도움이 된다. 변수에 배정할 적법한 값이 없으면 역추적이 일어난다. 충돌 지향 역도약은 문제의 근원으로 직접 도약한다.

최소 충돌 발견법을 이용한 국소 검색이 제약 만족 문제를 아주 성공적으로 푼 사례가 많이 있다.

CSP 해결의 복잡도는 제약 그래프의 구조에 크게 의존한다. 트리 구조 문제는 선형 시간으로 풀 수 있다. 절단 집합 조건부 적용을 이용하면 일반적인 CSP를 트리 구조의 CSP로 변환할 수 있다. 작은 절단 집합을 찾아낼 수 있다면 이 기법이 아주 효율적이다. 트리 분해 기법은 CSP를 부분 문제들의 트리로 변환한다. 이 기법은 제약 그래프의 트리 너비가 작을 때 효율적이다.















